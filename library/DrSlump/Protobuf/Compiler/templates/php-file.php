<?php
/*
    Receives the following variables:
        $namespace - The current namespace (aka package)
        $data      - A string with the generated source for the entities in the proto
        $nbSpaces  - The number of spaces
*/

echo '<?php'.PHP_EOL;
echo '// DO NOT EDIT! Generated by Protobuf-PHP protoc plugin '.\DrSlump\Protobuf\Protobuf::VERSION.PHP_EOL;
echo '// Source: '.$this->proto->name.PHP_EOL;
if ($this->option('timestamp', true)) {
    echo '// Date: '.gmdate('Y-m-d H:i:s').PHP_EOL;
}
echo PHP_EOL;
if ($this->option('insertions')) {
    echo '// @@protoc_insertion_point(scope_file)'.PHP_EOL;
    echo '// @@protoc_insertion_point(file_'.$this->proto->name.')'.PHP_EOL;
    echo $data;
} else {
    echo preg_replace('#^\s*//\s+@@protoc_insertion_point.*$\n#m', '', $data);
}
